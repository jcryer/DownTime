<!DOCTYPE html>
<html>
<head>
	<script>
		var canvas;
		var ctx;
		const WIDTH = 640;
		const HEIGHT = 480;
		var count = 0;
		cookiePic = new Image();
		cookiePic.src = 'Cookies.jpg';
		messagePic = new Image();
		messagePic.src = 'acceptCookies.jpg';

		var cx;
		var cy;
		newPos();

		function newPos(){
			cx = Math.floor((Math.random() *600) + 1);
			cy = Math.floor((Math.random() *430) + 1);
		}

		function mainLoop(){
			if(count < 6){
				ctx.fillStyle = "#FFFFFF";
				ctx.fillRect(0,0,WIDTH,HEIGHT);

				ctx.drawImage(cookiePic, cx-100	,cy-5,100,20);

				ctx.fillStyle = "#00FF00";
				ctx.fillRect(cx,cy,10,10);

				requestAnimationFrame(mainLoop);
			} else {
				ctx.fillStyle = "#FFFFFF";
				ctx.fillRect(0,0,WIDTH,HEIGHT);
			}

		}

		function clickCheck(x, y){
			if ((cx <= x && x <= (cx + 10)) && (cy <= y && y <= (cy + 10))){
				return true;	
			}
			return false;
		}

		function endGame(){
			if(count > 5){
				return true;
			}
			return false;
		}


	</script> 
</head>
<body>

	<canvas id="myCanvas"  width="640" height="480"></canvas>
	<script type="text/javascript">
		canvas = document.getElementById("myCanvas");
		canvas.addEventListener("mousedown", function(event)
			{
				var x = new Number();
		        var y = new Number();
		        x = event.clientX + document.body.scrollLeft +
		            document.documentElement.scrollLeft;
		        y = event.clientY + document.body.scrollTop +
		            document.documentElement.scrollTop;
		        

		        x -= canvas.offsetLeft;
		        y -= canvas.offsetTop;

				console.log(x,y,cx,cy,count);
				if(clickCheck(x,y)){
					newPos();
					count++;
				}
				
				if(endGame()){
					window.top.postMessage("done","*");
					var newD = new Date;
					endMin = newD.getMinutes();
					endSec = newD.getSeconds();
					EndTime = (60 * endMin) + endSec;
					timeTaken = EndTime - StartTime; 
					alert("Time: "+ timeTaken + " seconds");
				}
				});


		ctx = canvas.getContext("2d");
		var d = new Date();
		min = d.getMinutes();
		sec = d.getSeconds();
		StartTime = (60 * min) + sec;

		requestAnimationFrame(mainLoop);
	</script>

</body>
</html>